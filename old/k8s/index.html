<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Cheatsheets | Content</title>
    <meta name="description" content="How to ...">
    
    
    <link rel="preload" href="/cheatsheets/assets/css/16.styles.560813c4.css" as="style"><link rel="preload" href="/cheatsheets/assets/js/app.fc5f6e28.js" as="script"><link rel="preload" href="/cheatsheets/assets/js/1.f762f5d0.js" as="script"><link rel="prefetch" href="/cheatsheets/assets/js/9.faab97d4.js"><link rel="prefetch" href="/cheatsheets/assets/js/2.20a21022.js"><link rel="prefetch" href="/cheatsheets/assets/js/3.2d533ba2.js"><link rel="prefetch" href="/cheatsheets/assets/js/4.be7c8ea1.js"><link rel="prefetch" href="/cheatsheets/assets/js/5.8ed6b605.js"><link rel="prefetch" href="/cheatsheets/assets/js/6.a3a68cbe.js"><link rel="prefetch" href="/cheatsheets/assets/js/7.ee45a024.js"><link rel="prefetch" href="/cheatsheets/assets/js/8.999defee.js"><link rel="prefetch" href="/cheatsheets/assets/js/0.6337abd9.js"><link rel="prefetch" href="/cheatsheets/assets/js/10.b4f86ccc.js"><link rel="prefetch" href="/cheatsheets/assets/js/11.1bd7fae6.js"><link rel="prefetch" href="/cheatsheets/assets/js/12.8cd4c7d4.js"><link rel="prefetch" href="/cheatsheets/assets/js/13.cff22ed4.js"><link rel="prefetch" href="/cheatsheets/assets/js/14.7b06669e.js"><link rel="prefetch" href="/cheatsheets/assets/js/15.ebe8e3a6.js">
    <link rel="stylesheet" href="/cheatsheets/assets/css/16.styles.560813c4.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/cheatsheets/" class="home-link router-link-active"><!----><span class="site-name">
      Cheatsheets
    </span></a><div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div><!----></div></header><div class="sidebar-mask"></div><div class="sidebar"><!----><ul class="sidebar-links"><li><a href="/cheatsheets/" class="sidebar-link">Homepage</a></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Kubernetes</span><!----></p><ul class="sidebar-group-items"><li><a href="/cheatsheets/kubernetes/introduction.html" class="sidebar-link">Introduction</a></li><li><a href="/cheatsheets/kubernetes/setup-aws.html" class="sidebar-link">Setup AWS</a></li><li><a href="/cheatsheets/kubernetes/setup-domain-provider-ns.html" class="sidebar-link">Setup domain provider</a></li><li><a href="/cheatsheets/kubernetes/setup-machine-for-cluster-management.html" class="sidebar-link">Setup machine for cluster management</a></li><li><a href="/cheatsheets/kubernetes/init-cluster.html" class="sidebar-link">Init cluster</a></li><li><a href="/cheatsheets/kubernetes/dashboard-deploy.html" class="sidebar-link">Deploy dashboard</a></li><li><a href="/cheatsheets/kubernetes/install-ingress.html" class="sidebar-link">Install Ingress</a></li><li><a href="/cheatsheets/kubernetes/ingress-dashboard.html" class="sidebar-link">Serve dashboard through Ingress</a></li><li><a href="/cheatsheets/kubernetes/continuous-integration.html" class="sidebar-link">Continuous integration</a></li><li><a href="/cheatsheets/kubernetes/upgrade-cluster.html" class="sidebar-link">Upgrade &amp; downgrade cluster</a></li></ul></div></li></ul></div><div class="page"><div class="content"><h1 id="content"><a href="#content" aria-hidden="true" class="header-anchor">#</a> Content</h1><ul><li>Docker orchestration tools</li><li>Docker Cloud infrastructure</li><li>Kubernetes</li><li>Minikube</li><li>Init Kubernetes cluster</li><li>Kubernetes components</li><li>Containerization overview</li><li>Kubernetes infrastructure - 1</li><li>Kubernetes UI</li><li>Kubernetes infrastructure - 2</li><li>Ingress ?</li><li>Volumes ?</li><li>PetSets ?</li><li>HTTPS for the UI dashboard</li></ul><h1 id="docker-orchestration-tools"><a href="#docker-orchestration-tools" aria-hidden="true" class="header-anchor">#</a> Docker orchestration tools</h1><ul><li>Docker Cloud</li><li>Docker Swarm</li><li>Docker Compose</li><li>Kubernetes</li></ul><h1 id="docker-cloud-infrastructure"><a href="#docker-cloud-infrastructure" aria-hidden="true" class="header-anchor">#</a> Docker Cloud infrastructure</h1><ul><li>Repositories</li><li>Cluster</li><li>Nodes</li><li>Stacks</li><li>Services</li><li>Containers</li></ul><h1 id="kubernetes"><a href="#kubernetes" aria-hidden="true" class="header-anchor">#</a> Kubernetes</h1><p>Google Borg ~2007</p><ul><li>hundreds of thousands jobs</li><li>hundreds of clusters</li><li>10 thousands machines in each cluster</li><li>task-packing</li><li>machine sharing</li><li>process-level performance isolation</li><li>runtime features that minimize fault-recovery time</li><li>declarative job specification language</li><li>real-time job monitoring</li><li>tools to analyze and simulate system behavior</li></ul><p>Kubernetes or k8s - 2014</p><ul><li>production grade</li><li>open source</li><li>scaling</li><li>package manager - <a href="https://helm.sh" target="_blank" rel="noopener noreferrer">Helm</a></li><li>dashboard UI</li><li>cloud platform support</li><li>modular</li></ul><h1 id="minikube"><a href="#minikube" aria-hidden="true" class="header-anchor">#</a> Minikube</h1><p><a href="https://github.com/kubernetes/minikube" target="_blank" rel="noopener noreferrer">Minikube</a></p><h1 id="init-kubernetes-cluster"><a href="#init-kubernetes-cluster" aria-hidden="true" class="header-anchor">#</a> Init Kubernetes cluster</h1><p><a href="https://github.com/4doge/cheatsheets/blob/master/k8s/kubernetes.md" target="_blank" rel="noopener noreferrer">kubernetes.md</a></p><h1 id="kubernetes-components"><a href="#kubernetes-components" aria-hidden="true" class="header-anchor">#</a> Kubernetes components</h1><h4 id="master-components"><a href="#master-components" aria-hidden="true" class="header-anchor">#</a> Master components</h4><h6 id="etcd"><a href="#etcd" aria-hidden="true" class="header-anchor">#</a> etcd</h6><p>Storing master state and overall configuration. Notify other components about changes/updates of the state.</p><h6 id="api-server"><a href="#api-server" aria-hidden="true" class="header-anchor">#</a> API Server</h6><p>REST API. CRUD for the objects in etcd.</p><h6 id="scheduler"><a href="#scheduler" aria-hidden="true" class="header-anchor">#</a> Scheduler</h6><p>Binding API for the pods. Choose node for the new created pod.</p><h6 id="controller-manager-server"><a href="#controller-manager-server" aria-hidden="true" class="header-anchor">#</a> Controller Manager Server</h6><p>Discover and manage different controllers.</p><p><strong>Node Controller</strong>: Responsible for noticing and responding when nodes go down.</p><p><strong>Replication Controller</strong>: Responsible for maintaining the correct number of pods for every replication controller object in the system.</p><p><strong>Endpoints Controller</strong>: Populates the Endpoints object (that is, joins Services &amp; Pods).</p><p><strong>Service Account &amp; Token Controllers</strong>: Create default accounts and API access tokens for new namespaces.</p><h4 id="node-components"><a href="#node-components" aria-hidden="true" class="header-anchor">#</a> Node components</h4><h6 id="kubelet"><a href="#kubelet" aria-hidden="true" class="header-anchor">#</a> kubelet</h6><p>It makes sure that containers are running in a pod.</p><h6 id="kube-proxy"><a href="#kube-proxy" aria-hidden="true" class="header-anchor">#</a> kube-proxy</h6><p>Networking and port forwarding.</p><h6 id="container-runtime"><a href="#container-runtime" aria-hidden="true" class="header-anchor">#</a> Container Runtime</h6><p>Software that is responsible for running containers (docker, rkt, runc)</p><h1 id="containerization-overview"><a href="#containerization-overview" aria-hidden="true" class="header-anchor">#</a> Containerization overview</h1><ul><li>virtual machine vs container</li><li>containers on cloud</li></ul><h1 id="kubernetes-infrastructure-1"><a href="#kubernetes-infrastructure-1" aria-hidden="true" class="header-anchor">#</a> Kubernetes infrastructure - 1</h1><h6 id="pods"><a href="#pods" aria-hidden="true" class="header-anchor">#</a> pods</h6><ul><li>describe app in yaml or json</li><li>1 or more containers</li><li>communication between containers by local port numbers</li></ul><pre class="language-text"><code>kubectl create -f example.yml
kubectl get pod
kubectl describe pod &lt;pod_name&gt;
kubectl attach &lt;pod_name&gt; -i
kubectl exec &lt;pod_name&gt; -- &lt;command&gt;
kubectl delete pod &lt;pod_name&gt;
</code></pre><p>https://kubernetes.io/docs/reference/generated/federation/v1/definitions/</p><h6 id="services"><a href="#services" aria-hidden="true" class="header-anchor">#</a> services</h6><ul><li>access app outside the cluster</li><li>run ELB on AWS</li><li>route traffic to the correct pod</li><li>haproxy/nginx</li><li>domain name point to ELB (alias)</li><li>types: LoadBalancer / ClusterIP(default, reach only from the cluster) / NodePort(reachable externally)</li></ul><h1 id="kubernetes-ui"><a href="#kubernetes-ui" aria-hidden="true" class="header-anchor">#</a> Kubernetes UI</h1><p><a href="https://github.com/kubernetes/dashboard" target="_blank" rel="noopener noreferrer">Dashboard</a></p><h1 id="kubernetes-infrastructure-2"><a href="#kubernetes-infrastructure-2" aria-hidden="true" class="header-anchor">#</a> Kubernetes infrastructure - 2</h1><h6 id="replication-controllers"><a href="#replication-controllers" aria-hidden="true" class="header-anchor">#</a> replication controllers</h6><ul><li>stateless vs stateful</li><li>session management</li><li>localfiles management</li><li>scaling</li><li>ALWAYS USE replication controller instead of pod definition</li><li>can be specify only 1 replica
<code>kubectl scale --replicas=5 rc/helloworld-controller</code></li></ul><h6 id="replica-set"><a href="#replica-set" aria-hidden="true" class="header-anchor">#</a> replica set</h6><ul><li>next-generation replication controller</li><li>new selector(multiple)</li><li>used by deployment object</li></ul><h6 id="deployments"><a href="#deployments" aria-hidden="true" class="header-anchor">#</a> deployments</h6><ul><li>definition of state(e.g. state = &quot;run app 5 times&quot;)</li><li>replication controller or replica set = hard to manage, a lot of manual work</li><li>create/update application</li><li>rolling-updates (zero downtime)</li><li>rollbacks</li><li>pause/resume deployment</li></ul><pre class="language-text"><code>kubectl get deployments
kubectl get rs
kubectl set image deployment/helloworld-deployment k8s-demo=k8s-demo:2
kubectl rollout undo deployment/helloworld-deployment
</code></pre><h6 id="labels"><a href="#labels" aria-hidden="true" class="header-anchor">#</a> labels</h6><ul><li>label any object (pod/svc/rc/deployment)</li><li>key/value</li><li>multiple</li><li>tag node (run only on specific node)</li><li>nodeSelector</li></ul><pre class="language-text"><code>kubectl label node &lt;node_name&gt; key=value
kubectl get pods -l environment=production,tier=frontend
</code></pre><h6 id="healthchecks"><a href="#healthchecks" aria-hidden="true" class="header-anchor">#</a> healthchecks</h6><ul><li>types: periodical commands, periodical check over http</li><li>livenessProbe and readinessProbe</li><li>/healthz</li></ul><h6 id="secrets"><a href="#secrets" aria-hidden="true" class="header-anchor">#</a> secrets</h6><ul><li>&quot;secret&quot; data</li><li>key/value</li><li>use as env vars or file(via volume)</li></ul><h6 id="config-map"><a href="#config-map" aria-hidden="true" class="header-anchor">#</a> config map</h6><ul><li>credentials storing</li><li>key/value</li><li>use as env vars or file(via volume) or container commandline args</li></ul><pre class="language-text"><code>username=test
password=example
</code></pre><pre class="language-text"><code>kubectl create configmap app-config --from-file=example.txt
</code></pre></div><!----><!----></div></div></div>
    <script src="/cheatsheets/assets/js/1.f762f5d0.js" defer></script><script src="/cheatsheets/assets/js/app.fc5f6e28.js" defer></script>
  </body>
</html>
